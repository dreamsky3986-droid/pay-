
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI CHARACTER - Professional Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --neon-blue: #00f2ff;
            --deep-blue: #0a192f;
            --cyber-blue: #3b82f6;
        }

        html, body {
            height: auto !important;
            overflow-x: hidden;
            overflow-y: auto !important;
            background-color: #01040a;
            color: #e2e8f0;
            scroll-behavior: smooth;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        /* Scroll Handle Final */
        #scroll-handle {
            position: fixed;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 48px;
            height: 120px;
            background: linear-gradient(180deg, var(--neon-blue), var(--cyber-blue));
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            box-shadow: 0 0 30px rgba(0, 242, 255, 0.4);
            touch-action: none;
            cursor: grab;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .upload-card {
            background: rgba(10, 25, 47, 0.7);
            border: 1px solid rgba(0, 242, 255, 0.1);
            border-radius: 1.5rem;
            padding: 1.5rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }

        .upload-card:hover {
            border-color: var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.15);
            transform: translateY(-2px);
        }

        .drop-zone {
            aspect-ratio: 1 / 1;
            width: 100%;
            border: 2px dashed rgba(0, 242, 255, 0.2);
            border-radius: 1.25rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            background: rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }

        .preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            inset: 0;
            z-index: 5;
        }

        .preview-container {
            aspect-ratio: 9 / 16;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            background: #000;
            border-radius: 3rem;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(0, 242, 255, 0.3);
            box-shadow: 0 0 60px rgba(0, 242, 255, 0.1);
        }

        .scanner-line {
            position: absolute;
            width: 100%;
            height: 4px;
            background: var(--neon-blue);
            box-shadow: 0 0 25px var(--neon-blue);
            z-index: 20;
            animation: scan 2.5s infinite ease-in-out;
        }

        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2300f2ff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 1rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
        }

        .cyber-btn {
            background: linear-gradient(90deg, #00d2ff 0%, #3a7bd5 100%);
            color: white;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
            font-weight: 900;
            box-shadow: 0 0 25px rgba(0, 210, 255, 0.3);
            transition: all 0.3s ease;
        }

        .cyber-btn:hover {
            filter: brightness(1.1);
            box-shadow: 0 0 35px rgba(0, 210, 255, 0.5);
            transform: scale(1.02);
        }

        .cyber-btn:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body>

    <div id="scroll-handle">
        <i class="fas fa-expand-arrows-alt text-white text-xl"></i>
    </div>

    <div class="max-w-6xl mx-auto px-6 py-16">
        <header class="mb-14 border-b border-blue-900/40 pb-10 flex flex-col md:flex-row md:items-center justify-between gap-6">
            <div class="flex items-center gap-6">
                <div class="w-16 h-16 bg-blue-600 rounded-3xl flex items-center justify-center rotate-6 shadow-[0_0_30px_rgba(0,242,255,0.4)] border border-white/20">
                    <i class="fas fa-brain text-white text-3xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl font-black tracking-tighter uppercase italic leading-none">AI <span class="text-cyan-400">CHARACTER</span></h1>
                    <p class="text-[11px] text-cyan-500/80 uppercase tracking-[0.5em] font-bold mt-2">Professional Character Engine v31.0</p>
                </div>
            </div>
            <div class="hidden md:block">
                <div class="px-4 py-2 rounded-full border border-cyan-500/20 bg-cyan-500/5 text-[10px] font-bold text-cyan-400 uppercase tracking-widest">
                    <i class="fas fa-shield-alt mr-2"></i> Verified Stable Engine
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
            
            <!-- PANEL KONTROL -->
            <aside class="lg:col-span-5 space-y-8">
                
                <!-- 1. KARAKTER ASLI -->
                <div class="upload-card">
                    <h2 class="text-[12px] font-black uppercase tracking-widest mb-4 flex items-center gap-3 text-cyan-400">
                        <i class="fas fa-fingerprint"></i> 1. Foto Karakter (Utama)
                    </h2>
                    <div class="drop-zone" onclick="document.getElementById('char-input').click()">
                        <input type="file" id="char-input" class="hidden" accept="image/*" onchange="handlePreview(this, 'char-preview')">
                        <div id="char-ui" class="text-center p-6">
                            <i class="fas fa-user-circle text-4xl text-blue-900/50 mb-3"></i>
                            <p class="text-[9px] font-black text-blue-700 uppercase tracking-widest">Klik Untuk Input Wajah</p>
                        </div>
                        <img id="char-preview" class="preview-img hidden">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-5">
                    <!-- 2. ATASAN -->
                    <div class="upload-card">
                        <h2 class="text-[11px] font-black uppercase tracking-widest mb-4 text-cyan-400">2. Atasan</h2>
                        <div class="drop-zone" onclick="document.getElementById('top-input').click()">
                            <input type="file" id="top-input" class="hidden" accept="image/*" onchange="handlePreview(this, 'top-preview')">
                            <div id="top-ui" class="text-center p-2">
                                <i class="fas fa-tshirt text-2xl text-blue-900/50 mb-2"></i>
                                <p class="text-[8px] font-bold text-blue-700 uppercase">Input Atasan</p>
                            </div>
                            <img id="top-preview" class="preview-img hidden">
                        </div>
                    </div>

                    <!-- 3. BAWAHAN -->
                    <div class="upload-card">
                        <h2 class="text-[11px] font-black uppercase tracking-widest mb-4 text-cyan-400">3. Bawahan</h2>
                        <div class="drop-zone" onclick="document.getElementById('bot-input').click()">
                            <input type="file" id="bot-input" class="hidden" accept="image/*" onchange="handlePreview(this, 'bot-preview')">
                            <div id="bot-ui" class="text-center p-2">
                                <i class="fas fa-socks text-2xl text-blue-900/50 mb-2"></i>
                                <p class="text-[8px] font-bold text-blue-700 uppercase">Input Bawahan</p>
                            </div>
                            <img id="bot-preview" class="preview-img hidden">
                        </div>
                    </div>
                </div>

                <!-- 4. DATABASE POSE -->
                <div class="upload-card">
                    <h2 class="text-[12px] font-black uppercase tracking-widest mb-4 text-cyan-400">4. Seleksi Gaya & Pose</h2>
                    <select id="pose-select" class="w-full bg-black/60 border border-cyan-900/40 rounded-2xl px-6 py-5 text-[11px] font-black text-white outline-none appearance-none cursor-pointer hover:border-cyan-500/50 transition-colors">
                        <option value="Full body standing, frontal high-fashion pose, head facing camera">Berdiri (Frontal Style)</option>
                        <option value="Candid walking movement, side profile, maintaining facial features">Berjalan (Candid Movement)</option>
                        <option value="Sitting elegantly on a luxury sofa, artistic high-angle shot">Duduk (Elegant Artistic)</option>
                        <option value="Sitting on floor in a stylish M-pose, legs bent in M shape, fashion editorial perspective">Duduk Kaki M (M-Pose)</option>
                        <option value="Sitting on floor, legs wide apart, right leg raised straight up vertically, avant-garde fashion pose, editorial style">Duduk Kaki Terbuka & Kanan Lurus Ke Atas</option>
                        <option value="Dynamic action pose, perspective view from below">Perspektif Bawah (Dynamic View)</option>
                    </select>
                </div>

                <button id="btn-render" class="cyber-btn w-full py-8 rounded-3xl flex items-center justify-center gap-4 text-[13px] tracking-[0.4em] uppercase transition-all">
                    <i class="fas fa-rocket"></i> EXECUTE RENDER ENGINE
                </button>
            </aside>

            <!-- PREVIEW VIEWPORT -->
            <main class="lg:col-span-7 flex flex-col items-center">
                <div class="w-full bg-blue-950/10 border border-blue-900/30 rounded-[4rem] p-12 backdrop-blur-xl min-h-[900px] flex flex-col items-center shadow-inner">
                    <div class="preview-container">
                        <div id="scan-bar" class="scanner-line hidden"></div>
                        
                        <div id="loader" class="hidden absolute inset-0 bg-black/98 z-50 flex flex-col items-center justify-center p-14 text-center">
                            <div class="w-16 h-16 border-4 border-cyan-900/20 border-t-cyan-500 rounded-full animate-spin mb-8"></div>
                            <p class="text-[10px] font-black text-cyan-500 tracking-[0.5em] uppercase">Processing Identity VAE...</p>
                        </div>

                        <div id="empty-hint" class="absolute inset-0 flex flex-col items-center justify-center opacity-10">
                            <i class="fas fa-project-diagram text-9xl mb-8 text-cyan-500"></i>
                            <p class="text-[12px] font-black uppercase tracking-[0.5em] text-cyan-500 italic">SYSTEM READY</p>
                        </div>

                        <img id="result-img" class="hidden w-full h-full object-cover">
                    </div>

                    <button id="btn-save" class="hidden mt-12 px-16 py-6 bg-cyan-950/20 hover:bg-cyan-950/40 border border-cyan-500/30 rounded-3xl text-[11px] font-black uppercase tracking-widest text-cyan-400 flex items-center gap-5 transition-all shadow-lg shadow-cyan-500/5">
                        <i class="fas fa-cloud-download-alt"></i> DOWNLOAD HIGH-RES RENDER
                    </button>
                </div>
            </main>

        </div>
    </div>

    <script>
        const apiKey = "";
        let images = { char: "", top: "", bot: "" };

        // Handle Previews
        function handlePreview(input, imgId) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = document.getElementById(imgId);
                    preview.src = e.target.result;
                    preview.classList.remove('hidden');
                    document.getElementById(imgId.replace('preview', 'ui')).classList.add('hidden');
                    
                    const type = imgId.split('-')[0];
                    images[type] = e.target.result.split(',')[1];
                };
                reader.readAsDataURL(file);
            }
        }

        // Render Logic
        document.getElementById('btn-render').onclick = async () => {
            if (!images.char) return alert("Peringatan: Foto Karakter Utama Wajib Diunggah!");
            
            const loader = document.getElementById('loader');
            const resultImg = document.getElementById('result-img');
            const saveBtn = document.getElementById('btn-save');
            const scanBar = document.getElementById('scan-bar');
            const emptyHint = document.getElementById('empty-hint');
            const pose = document.getElementById('pose-select').value;

            loader.classList.remove('hidden');
            resultImg.classList.add('hidden');
            saveBtn.classList.add('hidden');
            scanBar.classList.remove('hidden');
            emptyHint.classList.add('hidden');

            const prompt = `CHARACTER IDENTITY ANCHOR: Use character face, hair, and skin. Combine with top and bottom images if provided. Pose: ${pose}. Aspect 9:16. Professional fashion render.`;

            try {
                const parts = [{ text: prompt }];
                if (images.char) parts.push({ inlineData: { mimeType: "image/png", data: images.char } });
                if (images.top) parts.push({ inlineData: { mimeType: "image/png", data: images.top } });
                if (images.bot) parts.push({ inlineData: { mimeType: "image/png", data: images.bot } });

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: parts }],
                        generationConfig: { responseModalities: ['IMAGE'] }
                    })
                });

                const data = await response.json();
                const result = data.candidates?.[0]?.content?.parts?.find(p => p.inlineData)?.inlineData?.data;

                if (result) {
                    resultImg.src = `data:image/png;base64,${result}`;
                    resultImg.classList.remove('hidden');
                    saveBtn.classList.remove('hidden');
                }
            } catch (err) {
                alert("Sistem gagal merender. Silakan coba lagi.");
            } finally {
                loader.classList.add('hidden');
                scanBar.classList.add('hidden');
            }
        };

        // Export
        document.getElementById('btn-save').onclick = () => {
            const a = document.createElement('a');
            a.download = 'ai-character-export.png';
            a.href = document.getElementById('result-img').src;
            a.click();
        };

        // Scroll Control
        const handle = document.getElementById('scroll-handle');
        let isDragging = false;
        let startY, startScroll;

        handle.addEventListener('touchstart', (e) => {
            isDragging = true;
            startY = e.touches[0].clientY;
            startScroll = window.pageYOffset;
        });

        window.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            const delta = e.touches[0].clientY - startY;
            window.scrollTo(0, startScroll + (delta * 3));
        });

        window.addEventListener('touchend', () => isDragging = false);
    </script>
</body>
</html>
